#!/bin/bash
set -e

# Trap errors to provide debugging info
trap 'notify-send --urgency critical "System refresh failed: Command '\''$BASH_COMMAND'\'' exited with code $?"; exit 1' ERR

# restart apps (noop if not running)
system-restart-app elephant
system-restart-app walker --gapplication-service
system-restart-app mako
system-restart-app --only-if-running waybar

hyprctl reload 2>/dev/null
system-update-awww

# Sync filesystem to ensure clean state
sync

notify-send "System has been refreshed!"
